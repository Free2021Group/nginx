--- nginx-1.2.1.orig/src/http/modules/ngx_http_range_filter_module.c
+++ nginx-1.2.1/src/http/modules/ngx_http_range_filter_module.c
@@ -322,6 +322,10 @@ ngx_http_range_parse(ngx_http_request_t
             range->start = start;
             range->end = end;
 
+            if (size > NGX_MAX_OFF_T_VALUE - (end - start)) {
+                return NGX_HTTP_RANGE_NOT_SATISFIABLE;
+            }
+
             size += end - start;
 
             if (ranges-- == 0) {
